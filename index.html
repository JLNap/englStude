<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LinguaSprint — миниапп</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg-orb orb-a"></div>
    <div class="bg-orb orb-b"></div>

    <header class="topbar container">
      <div>
        <p class="eyebrow">Мини‑приложение обучения</p>
        <h1>LinguaSprint</h1>
      </div>
      <nav class="tabs" aria-label="Режимы приложения">
        <button class="tab active" data-view="student">Ученик</button>
        <button class="tab" data-view="admin">Админка преподавателя</button>
      </nav>
    </header>

    <main class="container grid">
      <section id="student-view" class="panel show">
        <h2>Формат: Карточки</h2>
        <p class="muted">Выбери правильный перевод. При верном ответе карточка перевернется.</p>

        <p id="student-status" class="status"></p>

        <section class="panel inset gamification">
          <div class="gamification-head">
            <h3>Рейтинг и лига</h3>
            <button id="daily-bonus-btn" class="btn ghost small">Забрать daily бонус</button>
          </div>
          <p id="bonus-status" class="status"></p>

          <form id="player-form" class="player-form">
            <label>
              Ник в рейтинге
              <input type="text" id="player-name" required placeholder="Например, lingostar" />
            </label>
            <button type="submit" class="btn small">Сохранить ник</button>
          </form>

          <div class="stats-grid">
            <article class="stat-card">
              <span>Лига</span>
              <strong id="league-label">Bronze</strong>
            </article>
            <article class="stat-card">
              <span>XP</span>
              <strong id="xp-label">0</strong>
            </article>
            <article class="stat-card">
              <span>Коины</span>
              <strong id="coins-label">0</strong>
            </article>
            <article class="stat-card">
              <span>Стрик</span>
              <strong id="streak-label">0</strong>
            </article>
            <article class="stat-card">
              <span>Позиция</span>
              <strong id="rank-label">-</strong>
            </article>
          </div>

          <h3>Топ игроков</h3>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Ник</th>
                  <th>Лига</th>
                  <th>XP</th>
                </tr>
              </thead>
              <tbody id="leaderboard-table"></tbody>
            </table>
          </div>
        </section>

        <div class="progress-row">
          <span id="progress-label">Карточка 1 / 1</span>
          <span id="score-label">Верно: 0</span>
        </div>

        <div class="flashcard-wrap">
          <button id="card" class="flashcard" aria-live="polite">
            <span class="card-front">hello</span>
            <span class="card-back">привет</span>
          </button>
        </div>

        <div id="options" class="options"></div>

        <div class="actions">
          <button id="next-btn" class="btn" disabled>Следующая карточка</button>
          <button id="reset-btn" class="btn ghost">Начать заново</button>
        </div>

        <section class="panel inset payment">
          <h3>Созвон с преподавателем</h3>
          <p class="muted">После оплаты можно выбрать слот, и система создаст комнату в Jitsi.</p>

          <div id="payment-locked">
            <button id="pay-btn" class="btn accent">Оплатить урок (990 ₽)</button>
          </div>

          <form id="call-form" class="call-form hidden">
            <label>
              Имя
              <input type="text" id="student-name" required placeholder="Например, Алина" />
            </label>
            <label>
              Email
              <input type="email" id="student-email" required placeholder="you@email.com" />
            </label>
            <label>
              Время созвона
              <select id="call-slot" required>
                <option value="">Выбери слот</option>
                <option>Понедельник 19:00</option>
                <option>Среда 18:30</option>
                <option>Суббота 11:00</option>
              </select>
            </label>
            <button type="submit" class="btn">Записаться</button>
          </form>

          <p id="call-status" class="ok"></p>
        </section>
      </section>

      <section id="admin-view" class="panel">
        <h2>Удобная админка</h2>
        <p class="muted">Карточки хранятся в Supabase. Преподаватель входит по email/password.</p>
        <p id="admin-status" class="status"></p>

        <div id="auth-block" class="panel inset auth-card">
          <h3>Вход для преподавателя</h3>
          <form id="auth-form" class="admin-form">
            <label>
              Email
              <input type="email" id="auth-email" required placeholder="teacher@mail.com" />
            </label>
            <label>
              Пароль
              <input type="password" id="auth-password" required placeholder="********" />
            </label>
            <div class="actions">
              <button type="submit" class="btn">Войти</button>
              <button type="button" id="signup-btn" class="btn ghost">Создать аккаунт</button>
            </div>
          </form>
        </div>

        <div id="admin-content" class="hidden">
          <div class="actions">
            <button id="logout-btn" class="btn ghost">Выйти</button>
            <button id="seed-btn" class="btn ghost">Добавить тестовые карточки</button>
          </div>

          <form id="task-form" class="admin-form">
            <label>
              Английское слово
              <input type="text" id="word" required placeholder="apple" />
            </label>
            <label>
              Правильный перевод
              <input type="text" id="answer" required placeholder="яблоко" />
            </label>
            <label>
              Варианты ответов (через запятую, минимум 3)
              <input type="text" id="options-input" required placeholder="яблоко, груша, банан" />
            </label>
            <div class="actions">
              <button type="submit" class="btn">Сохранить задание</button>
              <button type="button" id="clear-edit" class="btn ghost hidden">Отменить редактирование</button>
            </div>
          </form>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Слово</th>
                  <th>Перевод</th>
                  <th>Варианты</th>
                  <th>Действия</th>
                </tr>
              </thead>
              <tbody id="tasks-table"></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>

    <template id="option-template">
      <button class="option-btn"></button>
    </template>

    <script src="config.js"></script>
    <script type="module" src="app.js"></script>
  </body>
</html>
